<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Customer Chat</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- PubNub SDK -->
<script src="https://cdn.pubnub.com/sdk/javascript/pubnub.7.2.0.min.js"></script>

<style>
body{
  margin:0;
  font-family:system-ui;
  background:#f4f4f4;
  height:100vh;
  display:flex;
  flex-direction:column;
}

.header{
  background:#FFDE59;
  padding:12px;
  font-weight:600;
}

.chat{
  flex:1;
  padding:12px;
  overflow-y:auto;
}

.msg{
  padding:10px 12px;
  border-radius:12px;
  margin-bottom:8px;
  max-width:80%;
}

.me{
  background:#fff;
  margin-left:auto;
}

.astro{
  background:#e8f0ff;
}

.controls{
  display:flex;
  gap:8px;
  padding:10px;
  background:#fff;
}

.controls input{
  flex:1;
  padding:10px;
  border-radius:20px;
  border:1px solid #ccc;
}

.controls button{
  padding:10px 16px;
  border-radius:20px;
  background:#FFDE59;
  border:none;
  font-weight:600;
}
</style>
</head>

<body>

<div class="header">
  Customer Chat
</div>

<div id="chat" class="chat"></div>

<div class="controls">
  <input id="msg" placeholder="Type your messageâ€¦" />
  <button onclick="send()">Send</button>
</div>

<script>
/* ================= PUBNUB SETUP ================= */
const CHANNEL = "astro_gautam_chat";

const pubnub = new PubNub({
  publishKey: "pub-c-a90a128a-4e77-4b6a-bbb3-59d0fb688ddc",
  subscribeKey: "sub-c-1b514e35-fab1-4baf-88f1-6b628ab7e9c2",
  uuid: "Customer_" + Math.random().toString(36).slice(2,7)
});

const chat = document.getElementById("chat");

/* ================= SUBSCRIBE ================= */
pubnub.subscribe({ channels: [CHANNEL] });

/* ================= RECEIVE MESSAGES ================= */
pubnub.addListener({
  message: function (event) {
    const m = event.message;

    // Ignore own messages
    if (m.sender === pubnub.getUUID()) return;

    addMsg("Astrologer: " + m.text, "astro");
  }
});

/* ================= SEND MESSAGE ================= */
function send(){
  const input = document.getElementById("msg");
  const text = input.value.trim();
  if(!text) return;

  input.value = "";

  // Show locally
  addMsg("You: " + text, "me");

  // Send to astrologer
  pubnub.publish({
    channel: CHANNEL,
    message: {
      sender: pubnub.getUUID(),
      text: text
    }
  });
}

/* ================= UI HELPER ================= */
function addMsg(text, type){
  const d = document.createElement("div");
  d.className = "msg " + (type === "me" ? "me" : "astro");
  d.textContent = text;
  chat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
}
</script>

</body>
</html>









