<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Chat with Astrologer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{margin:0;font-family:system-ui;background:#f6f2ec;height:100vh;display:flex;flex-direction:column}
.header{background:#8b1d2c;color:#fff;padding:14px;display:flex;gap:10px;align-items:center}
.avatar{width:36px;height:36px;border-radius:50%;background:#fff}
.chat{flex:1;padding:14px;overflow-y:auto}
.msg{background:#ffe6d5;padding:10px 12px;border-radius:12px;margin-bottom:8px;max-width:70%;margin-left:auto}
.controls{display:flex;gap:8px;padding:12px;background:#fff}
input{flex:1;padding:10px;border-radius:20px;border:1px solid #ccc}
button{padding:10px 16px;border-radius:20px;border:none;background:#f8cfa7;font-weight:700}
</style>
</head>

<body>

<div class="header">
  <div class="avatar"></div>
  <div>
    <strong>Astrologer Gautam</strong><br>
    <small>Online</small>
  </div>
</div>

<div id="chat" class="chat"></div>

<div class="controls">
  <input id="msg" placeholder="Type messageâ€¦" />
  <button onclick="send()">Send</button>
</div>

<script>
/* ðŸ”´ PUT YOUR FIREBASE CONFIG HERE */
firebase.initializeApp({
  apiKey:  "AIzaSyBPOzL5ZoYd0NelkDNYk0LGBPDYVT2Tqew",
  authDomain: "connect-astro-e5309.firebaseapp.com",
  projectId: "connect-astro-e5309"
});

const db = firebase.firestore();

// Unique IDs
const customerId = "cust_" + Math.random().toString(36).slice(2,8);
const sessionId = "sess_" + Date.now();

// Create session
db.collection("sessions").doc(sessionId).set({
  astrologerId: "Gautam",
  customerId,
  status: "active",
  createdAt: firebase.firestore.FieldValue.serverTimestamp()
});

// Listen messages
db.collection("sessions").doc(sessionId)
  .collection("messages")
  .orderBy("createdAt")
  .onSnapshot(snap=>{
    const chat=document.getElementById("chat");
    chat.innerHTML="";
    snap.forEach(d=>{
      const m=d.data();
      const div=document.createElement("div");
      div.className="msg";
      div.textContent=m.text;
      chat.appendChild(div);
    });
    chat.scrollTop=chat.scrollHeight;
  });

// Send message
function send(){
  const input=document.getElementById("msg");
  const text=input.value.trim();
  if(!text)return;
  input.value="";
  db.collection("sessions").doc(sessionId)
    .collection("messages").add({
      sender:"customer",
      text,
      createdAt:firebase.firestore.FieldValue.serverTimestamp()
    });
}
</script>
</body>
</html>






