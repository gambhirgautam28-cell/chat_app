<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Chat with Astrologer</title>

<style>
body { margin:0; font-family: system-ui; background:#f4f4f4; }
.header {
  background:#8b1d2c; color:#fff; padding:12px;
  display:flex; align-items:center; gap:10px;
}
.header img { width:38px; height:38px; border-radius:50%; }
.header .right { margin-left:auto; display:flex; gap:12px; align-items:center; }
.wallet { cursor:pointer; }
.timer { color:#ffd966; font-weight:600; }

.chat { padding:14px; height:70vh; overflow:auto; }
.msg { background:#fff; padding:10px; border-radius:10px; margin-bottom:8px; width:fit-content; }
.me { background:#ffe7dc; margin-left:auto; }

.input {
  display:flex; padding:10px; gap:10px; background:#fff;
}
input { flex:1; padding:10px; border-radius:20px; border:1px solid #ddd; }
button { padding:10px 16px; border-radius:20px; border:none; background:#ffb37b; font-weight:600; }

.overlay {
  position:fixed; inset:0; background:rgba(0,0,0,.5);
  display:none; align-items:center; justify-content:center;
}
.card {
  background:#fff; padding:20px; border-radius:14px; width:90%; max-width:380px;
}
.card h3 { margin-top:0; }

.recharge-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; }
.recharge { padding:14px; border:1px solid #ddd; border-radius:10px; text-align:center; cursor:pointer; }

.hidden { display:none; }
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
  <img src="https://via.placeholder.com/80"/>
  <div>
    <div><b>Astrologer Gautam</b></div>
    <div class="timer" id="timer">00:00</div>
  </div>

  <div class="right">
    <div class="wallet" onclick="openWallet()">üí∞ ‚Çπ<span id="wallet">0</span></div>
    <button onclick="endChat()">End</button>
  </div>
</div>

<!-- CHAT -->
<div class="chat" id="chat"></div>

<!-- INPUT -->
<div class="input">
  <input id="text" placeholder="Type message..." />
  <button onclick="send()">Send</button>
</div>

<!-- BIRTH FORM -->
<div class="overlay" id="formOverlay">
  <div class="card">
    <h3>Enter Birth Details</h3>
    <input id="name" placeholder="Full Name"/><br><br>
    <input id="dob" type="date"/><br><br>
    <input id="time" type="time"/><br><br>
    <input id="place" placeholder="Birth Place"/><br><br>
    <button onclick="startChat()">Start Chat</button>
  </div>
</div>

<!-- WALLET -->
<div class="overlay" id="walletOverlay">
  <div class="card">
    <h3>Add Money</h3>
    <div class="recharge-grid">
      <div class="recharge" onclick="addMoney(50)">‚Çπ50</div>
      <div class="recharge" onclick="addMoney(100)">‚Çπ100</div>
      <div class="recharge" onclick="addMoney(200)">‚Çπ200</div>
      <div class="recharge" onclick="addMoney(500)">‚Çπ500</div>
      <div class="recharge" onclick="addMoney(1000)">‚Çπ1000</div>
      <div class="recharge" onclick="addMoney(5000)">‚Çπ5000</div>
    </div>
    <br>
    <button onclick="closeWallet()">Close</button>
  </div>
</div>

<script>
/* CONFIG */
const pricePerMinute = 10; // comes from astrologer
let wallet = 0;
let seconds = 0;
let timerInt;

/* UI INIT */
document.getElementById("formOverlay").style.display = "flex";

/* CHAT */
function send(){
  if(seconds <= 0) return;
  const t = text.value.trim();
  if(!t) return;
  addMsg(t,true);
  text.value="";
}

function addMsg(t,me){
  const d=document.createElement("div");
  d.className="msg"+(me?" me":"");
  d.innerText=t;
  chat.appendChild(d);
  chat.scrollTop=chat.scrollHeight;
}

/* START CHAT */
function startChat(){
  if(!name.value||!dob.value||!time.value||!place.value){
    alert("Fill all details");
    return;
  }

  if(wallet < pricePerMinute*5){
    alert("Minimum recharge required");
    return;
  }

  addMsg(
`Name: ${name.value}
DOB: ${dob.value}
Time: ${time.value}
Place: ${place.value}`,false);

  seconds = Math.floor((wallet/pricePerMinute)*60);
  document.getElementById("formOverlay").style.display="none";
  runTimer();
}

/* TIMER */
function runTimer(){
  updateTimer();
  timerInt=setInterval(()=>{
    seconds--;
    wallet = Math.max(0, wallet - pricePerMinute/60);
    updateTimer();

    if(seconds===60) addMsg("‚ö†Ô∏è 1 minute left. Please recharge.",false);
    if(seconds===30) addMsg("‚ö†Ô∏è 30 seconds left. Recharge now.",false);

    if(seconds<=0){
      clearInterval(timerInt);
      addMsg("‚õî Chat ended due to low balance.",false);
    }
  },1000);
}

function updateTimer(){
  const m=Math.floor(seconds/60);
  const s=seconds%60;
  timer.innerText=`${m}:${s.toString().padStart(2,"0")}`;
  document.getElementById("wallet").innerText=Math.floor(wallet);
}

/* WALLET */
function openWallet(){ walletOverlay.style.display="flex"; }
function closeWallet(){ walletOverlay.style.display="none"; }

function addMoney(a){
  wallet+=a;
  seconds+=Math.floor((a/pricePerMinute)*60);
  updateTimer();
  closeWallet();
}

/* END */
function endChat(){
  seconds=0;
  clearInterval(timerInt);
  addMsg("‚õî Chat ended.",false);
}
</script>

</body>
</html>





